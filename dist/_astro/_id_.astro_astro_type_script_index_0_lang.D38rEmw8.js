import{a as S,i as A}from"./store.SSxY7c3i.js";function v(){const r=document.getElementById("main-img"),m=document.querySelectorAll(".thumb-item"),g=document.getElementById("carousel-container"),p=document.getElementById("current-idx"),h=document.getElementById("prev-btn"),I=document.getElementById("next-btn"),B=document.getElementById("tap-prev"),L=document.getElementById("tap-next");let d=[];if(r)try{d=JSON.parse(r.getAttribute("data-images")||"[]")}catch{}let e=0;const o=d.length,a=t=>{o!==0&&(t<0&&(t=o-1),t>=o&&(t=0),e=t,r&&(r.style.opacity="0.5",setTimeout(()=>{r.src=d[e],r.style.opacity="1"},150)),p&&(p.innerText=(e+1).toString()),m.forEach((c,i)=>{i===e?c.classList.add("active"):c.classList.remove("active")}))};h?.addEventListener("click",()=>a(e-1)),I?.addEventListener("click",()=>a(e+1)),B?.addEventListener("click",t=>{t.preventDefault(),a(e-1)}),L?.addEventListener("click",t=>{t.preventDefault(),a(e+1)}),m.forEach(t=>{t.addEventListener("click",()=>{const c=parseInt(t.getAttribute("data-index")||"0");a(c)})});let l=0,u=0;g?.addEventListener("touchstart",t=>{l=t.changedTouches[0].screenX},{passive:!0}),g?.addEventListener("touchend",t=>{u=t.changedTouches[0].screenX,b()},{passive:!0});const b=()=>{if(o<=1)return;const t=50;u<l-t&&a(e+1),u>l+t&&a(e-1)},E=document.getElementById("qty-val"),x=document.getElementById("qty-minus"),T=document.getElementById("qty-plus"),n=document.getElementById("add-to-cart-btn");let s=1;const y=()=>{E&&(E.innerText=s.toString())};x?.addEventListener("click",()=>{s>1&&(s--,y())}),T?.addEventListener("click",()=>{s++,y()}),!n?.hasAttribute("data-init")&&(n?.setAttribute("data-init","true"),n?.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const c=n.getAttribute("data-safe-json");if(c)try{const i=JSON.parse(decodeURIComponent(c));for(let f=0;f<s;f++)S(i);A.set(!0);const k=n.innerText;n.innerText="已加入！",n.style.background="#5D4037",setTimeout(()=>{n.innerText=k,n.style.background=""},1e3)}catch(i){console.error("Cart Error:",i)}}))}document.addEventListener("astro:page-load",v);v();
