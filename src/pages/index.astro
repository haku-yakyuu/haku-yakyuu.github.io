---
import Layout from '../layouts/Layout.astro';
import ProductCard from '../components/ProductCard.astro';
import { getHakuData } from '../utils/api';

const { products, config, solidTagsList } = await getHakuData();

const featuredProducts = products.filter(p => p.isFeatured);
const allProducts = products; 
---

<Layout title="Home" siteTitle={config.site_title}>

    {featuredProducts.length > 0 && (
        <section>
            <h2>FEATURED <span>精選商品</span></h2>
            <div class="p-grid grid-vertical">
                {featuredProducts.map(product => (
                    <ProductCard product={product} solidTagsList={solidTagsList} />
                ))}
            </div>
        </section>
    )}

    <section>
        <h2>ALL PRODUCTS <span>全商品一覧</span></h2>
        <div class="p-grid grid-mixed">
            {allProducts.map(product => (
                <ProductCard product={product} solidTagsList={solidTagsList} />
            ))}
        </div>
    </section>

</Layout>

<style>
    .p-grid { display: grid; gap: 20px; width: 100%; }
    .grid-vertical { grid-template-columns: repeat(2, 1fr); }
    @media (min-width: 1024px) { .grid-vertical { grid-template-columns: repeat(4, 1fr); gap: 30px; } }
    .grid-mixed { grid-template-columns: 1fr; }
    @media (min-width: 768px) {
        .grid-mixed { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
    }
</style>
